import BlogCodeWalkthroughLayout from "../../components/BlogCodeWalkthroughLayout";
export default (props) => <BlogCodeWalkthroughLayout {...props} />;

# Composition API

## Reusable **stateful logic** in VueJS

---

## UI as a function of state

One of the core principles of React, Vue and other frameworks or libraries, is that the UI is simply the result of passing **state** through a function.

<small>

(you don't even need a framework to apply this concept)

</small>

```js
UI = fn(state);
```

---

State is data that changes over time. In other words, a **data stream**.

Every time state changes, an update of the UI is scheduled. The resulting UI is the result of calling a function with the new state. (so, again, `UI = fn(state)`).

---

**Stateful logic** is all the logic that causes state updates. These are the rules that the state follows.

For example, in the following image there's a representation of a state that changes every time something is retrieved from the server, which happens every time the user clicks on something. The stateful logic here would be the relation between the click event, the server, and the change in state.

<img src="/blog/refactoring-to-vue-3/state-stream.svg" alt="" style={{backgroundColor: "#ffffff99"}}/>

---

## Stateful logic in Vue

Let's see how we could represent some simple stateful logic in a VueJS component.

We will start with a component that renders the current window width.

```html
<template>
  <div>Window width is: {{ windowWidth }}</div>
</template>

<script>
  export default {
    data() {
      return {
        windowWidth: window.innerWidth,
      };
    },
  };
</script>
```

---

Also, let's focus on the script part only.

You might have noticed an error here. The value of the window width is calculated when the component is mounted, but it's not updated afterwards if the user resizes the browser.

```html 5:13
<template>
  <div>Window width is: {{ windowWidth }}</div>
</template>

<script>
  export default {
    data() {
      return {
        windowWidth: window.innerWidth,
      };
    },
  };
</script>
```

---

To fix this component, we should add **resize** event handlers to our component.

```html 11:22
<template>
  <div>Window width is: {{ windowWidth }}</div>
</template>

<script>
  export default {
    data() {
      return {
        windowWidth: window.innerWidth,
      };
    },
    mounted() {
      window.addEventListener("resize", this.calculateWindowWidth);
    },
    beforeDestroy() {
      window.removeEventListener("resize", this.calculateWindowWidth);
    },
    methods: {
      calculateWindowWidth() {
        this.windowWidth = window.innerWidth;
      },
    },
  };
</script>
```
